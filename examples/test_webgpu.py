from wgpu.utils._device import get_default_device

wgpu_device = get_default_device()
prg = """fn nan() -> f32 { let bits = 0xffffffffu; return bitcast<f32>(bits); }
@group(0) @binding(0) var<storage,read_write> data0: array<f32>;
@group(0) @binding(1) var<storage,read_write> data1: array<f32>;
@group(0) @binding(2) var<storage,read_write> data2: array<f16>;
@group(0) @binding(3) var<storage,read_write> data3: array<f16>;
@group(0) @binding(4) var<storage,read_write> data4: array<f16>;
@group(0) @binding(5) var<storage,read_write> data5: array<f16>;
@group(0) @binding(6) var<storage,read_write> data6: array<f16>;
@compute @workgroup_size(16,8) fn r_4_24_5_8_16_3_4_4_3_3(@builtin(workgroup_id) gindex: vec3<u32>, @builtin(local_invocation_id) lindex: vec3<u32>) {
  let gidx0 = i32(gindex.z); /* 4 */
  let gidx1 = i32(gindex.y); /* 24 */
  let gidx2 = i32(gindex.x); /* 5 */
  let lidx3 = i32(lindex.y); /* 8 */
  let lidx4 = i32(lindex.x); /* 16 */
  var  acc0 = (0.0f);
  var  acc1 = (0.0f);
  var  acc2 = (0.0f);
  var  acc3 = (0.0f);
  var  acc4 = (0.0f);
  var  acc5 = (0.0f);
  var  acc6 = (0.0f);
  var  acc7 = (0.0f);
  var  acc8 = (0.0f);
  var  acc9 = (0.0f);
  var  acc10 = (0.0f);
  var  acc11 = (0.0f);
  var  acc12 = (0.0f);
  var  acc13 = (0.0f);
  var  acc14 = (0.0f);
  var  acc15 = (0.0f);
  for(var ridx0 = (0); ridx0 < (3); ridx0++) {
    var  alu0 = f32(((gidx2*((-128)))+(lidx4*((-8))))<(0));
    var  alu1 = f32(((gidx1*((-16)))+(lidx3*((-2))))<(0));
    var  val0 = select(f32((0.0f)), f32(data1[(gidx2*(128))+(lidx4*(8))+(gidx1*(10240))+(lidx3*(1280))+(ridx0*(245760))+((-641))]), bool((alu0*alu1)));
    var  val1 = select(f32((0.0f)), f32(data1[(gidx2*(128))+(lidx4*(8))+(gidx1*(10240))+(lidx3*(1280))+(ridx0*(245760))+((-639))]), bool(alu1));
    var  val2 = select(f32((0.0f)), f32(data1[(gidx2*(128))+(lidx4*(8))+(gidx1*(10240))+(lidx3*(1280))+(ridx0*(245760))+((-637))]), bool(alu1));
    var  val3 = select(f32((0.0f)), f32(data1[(gidx2*(128))+(lidx4*(8))+(gidx1*(10240))+(lidx3*(1280))+(ridx0*(245760))+((-635))]), bool(alu1));
    var  val4 = select(f32((0.0f)), f32(data1[(gidx2*(128))+(lidx4*(8))+(gidx1*(10240))+(lidx3*(1280))+(ridx0*(245760))+((-640))]), bool(alu1));
    var  val5 = select(f32((0.0f)), f32(data1[(gidx2*(128))+(lidx4*(8))+(gidx1*(10240))+(lidx3*(1280))+(ridx0*(245760))+((-638))]), bool(alu1));
    var  val6 = select(f32((0.0f)), f32(data1[(gidx2*(128))+(lidx4*(8))+(gidx1*(10240))+(lidx3*(1280))+(ridx0*(245760))+((-636))]), bool(alu1));
    var  val7 = select(f32((0.0f)), f32(data1[(gidx2*(128))+(lidx4*(8))+(gidx1*(10240))+(lidx3*(1280))+(ridx0*(245760))+((-634))]), bool(alu1));
    var  val8 = select(f32((0.0f)), f32(data1[(gidx2*(128))+(lidx4*(8))+(gidx1*(10240))+(lidx3*(1280))+(ridx0*(245760))+((-633))]), bool(alu1));
    var  val9 = select(f32((0.0f)), f32(data1[(gidx2*(128))+(lidx4*(8))+(gidx1*(10240))+(lidx3*(1280))+(ridx0*(245760))+((-1))]), bool(alu0));
    var  val10 = f32(data1[(gidx2*(128))+(lidx4*(8))+(gidx1*(10240))+(lidx3*(1280))+(ridx0*(245760))+(1)]);
    var  val11 = f32(data1[(gidx2*(128))+(lidx4*(8))+(gidx1*(10240))+(lidx3*(1280))+(ridx0*(245760))+(3)]);
    var  val12 = f32(data1[(gidx2*(128))+(lidx4*(8))+(gidx1*(10240))+(lidx3*(1280))+(ridx0*(245760))+(5)]);
    var  val13 = f32(data1[(gidx2*(128))+(lidx4*(8))+(gidx1*(10240))+(lidx3*(1280))+(ridx0*(245760))]);
    var  val14 = f32(data1[(gidx2*(128))+(lidx4*(8))+(gidx1*(10240))+(lidx3*(1280))+(ridx0*(245760))+(2)]);
    var  val15 = f32(data1[(gidx2*(128))+(lidx4*(8))+(gidx1*(10240))+(lidx3*(1280))+(ridx0*(245760))+(4)]);
    var  val16 = f32(data1[(gidx2*(128))+(lidx4*(8))+(gidx1*(10240))+(lidx3*(1280))+(ridx0*(245760))+(6)]);
    var  val17 = f32(data1[(gidx2*(128))+(lidx4*(8))+(gidx1*(10240))+(lidx3*(1280))+(ridx0*(245760))+(7)]);
    var  val18 = select(f32((0.0f)), f32(data1[(gidx2*(128))+(lidx4*(8))+(gidx1*(10240))+(lidx3*(1280))+(ridx0*(245760))+(639)]), bool(alu0));
    var  val19 = f32(data1[(gidx2*(128))+(lidx4*(8))+(gidx1*(10240))+(lidx3*(1280))+(ridx0*(245760))+(641)]);
    var  val20 = f32(data1[(gidx2*(128))+(lidx4*(8))+(gidx1*(10240))+(lidx3*(1280))+(ridx0*(245760))+(643)]);
    var  val21 = f32(data1[(gidx2*(128))+(lidx4*(8))+(gidx1*(10240))+(lidx3*(1280))+(ridx0*(245760))+(645)]);
    var  val22 = f32(data1[(gidx2*(128))+(lidx4*(8))+(gidx1*(10240))+(lidx3*(1280))+(ridx0*(245760))+(640)]);
    var  val23 = f32(data1[(gidx2*(128))+(lidx4*(8))+(gidx1*(10240))+(lidx3*(1280))+(ridx0*(245760))+(642)]);
    var  val24 = f32(data1[(gidx2*(128))+(lidx4*(8))+(gidx1*(10240))+(lidx3*(1280))+(ridx0*(245760))+(644)]);
    var  val25 = f32(data1[(gidx2*(128))+(lidx4*(8))+(gidx1*(10240))+(lidx3*(1280))+(ridx0*(245760))+(646)]);
    var  val26 = f32(data1[(gidx2*(128))+(lidx4*(8))+(gidx1*(10240))+(lidx3*(1280))+(ridx0*(245760))+(647)]);
    var  val27 = f32(f32(data2[(gidx0*(108))+(ridx0*(9))]));
    var  val28 = f32(f32(data2[(gidx0*(108))+(ridx0*(9))+(27)]));
    var  val29 = f32(f32(data2[(gidx0*(108))+(ridx0*(9))+(54)]));
    var  val30 = f32(f32(data2[(gidx0*(108))+(ridx0*(9))+(81)]));
    var  val31 = f32(f32(data2[(gidx0*(108))+(ridx0*(9))+(1)]));
    var  val32 = f32(f32(data2[(gidx0*(108))+(ridx0*(9))+(28)]));
    var  val33 = f32(f32(data2[(gidx0*(108))+(ridx0*(9))+(55)]));
    var  val34 = f32(f32(data2[(gidx0*(108))+(ridx0*(9))+(82)]));
    var  val35 = f32(f32(data2[(gidx0*(108))+(ridx0*(9))+(2)]));
    var  val36 = f32(f32(data2[(gidx0*(108))+(ridx0*(9))+(29)]));
    var  val37 = f32(f32(data2[(gidx0*(108))+(ridx0*(9))+(56)]));
    var  val38 = f32(f32(data2[(gidx0*(108))+(ridx0*(9))+(83)]));
    var  val39 = f32(f32(data2[(gidx0*(108))+(ridx0*(9))+(3)]));
    var  val40 = f32(f32(data2[(gidx0*(108))+(ridx0*(9))+(30)]));
    var  val41 = f32(f32(data2[(gidx0*(108))+(ridx0*(9))+(57)]));
    var  val42 = f32(f32(data2[(gidx0*(108))+(ridx0*(9))+(84)]));
    var  val43 = f32(f32(data2[(gidx0*(108))+(ridx0*(9))+(4)]));
    var  val44 = f32(f32(data2[(gidx0*(108))+(ridx0*(9))+(31)]));
    var  val45 = f32(f32(data2[(gidx0*(108))+(ridx0*(9))+(58)]));
    var  val46 = f32(f32(data2[(gidx0*(108))+(ridx0*(9))+(85)]));
    var  val47 = f32(f32(data2[(gidx0*(108))+(ridx0*(9))+(5)]));
    var  val48 = f32(f32(data2[(gidx0*(108))+(ridx0*(9))+(32)]));
    var  val49 = f32(f32(data2[(gidx0*(108))+(ridx0*(9))+(59)]));
    var  val50 = f32(f32(data2[(gidx0*(108))+(ridx0*(9))+(86)]));
    var  val51 = f32(f32(data2[(gidx0*(108))+(ridx0*(9))+(6)]));
    var  val52 = f32(f32(data2[(gidx0*(108))+(ridx0*(9))+(33)]));
    var  val53 = f32(f32(data2[(gidx0*(108))+(ridx0*(9))+(60)]));
    var  val54 = f32(f32(data2[(gidx0*(108))+(ridx0*(9))+(87)]));
    var  val55 = f32(f32(data2[(gidx0*(108))+(ridx0*(9))+(7)]));
    var  val56 = f32(f32(data2[(gidx0*(108))+(ridx0*(9))+(34)]));
    var  val57 = f32(f32(data2[(gidx0*(108))+(ridx0*(9))+(61)]));
    var  val58 = f32(f32(data2[(gidx0*(108))+(ridx0*(9))+(88)]));
    var  val59 = f32(f32(data2[(gidx0*(108))+(ridx0*(9))+(8)]));
    var  val60 = f32(f32(data2[(gidx0*(108))+(ridx0*(9))+(35)]));
    var  val61 = f32(f32(data2[(gidx0*(108))+(ridx0*(9))+(62)]));
    var  val62 = f32(f32(data2[(gidx0*(108))+(ridx0*(9))+(89)]));
    acc0 = fma(val19,val59,fma(val22,val55,fma(val18,val51,fma(val10,val47,fma(val13,val43,fma(val9,val39,fma(val1,val35,fma(val4,val31,fma(val0,val27,acc0)))))))));
    acc1 = fma(val20,val59,fma(val23,val55,fma(val19,val51,fma(val11,val47,fma(val14,val43,fma(val10,val39,fma(val2,val35,fma(val5,val31,fma(val1,val27,acc1)))))))));
    acc2 = fma(val21,val59,fma(val24,val55,fma(val20,val51,fma(val12,val47,fma(val15,val43,fma(val11,val39,fma(val3,val35,fma(val6,val31,fma(val2,val27,acc2)))))))));
    acc3 = fma(val26,val59,fma(val25,val55,fma(val21,val51,fma(val17,val47,fma(val16,val43,fma(val12,val39,fma(val8,val35,fma(val7,val31,fma(val3,val27,acc3)))))))));
    acc4 = fma(val19,val60,fma(val22,val56,fma(val18,val52,fma(val10,val48,fma(val13,val44,fma(val9,val40,fma(val1,val36,fma(val4,val32,fma(val0,val28,acc4)))))))));
    acc5 = fma(val20,val60,fma(val23,val56,fma(val19,val52,fma(val11,val48,fma(val14,val44,fma(val10,val40,fma(val2,val36,fma(val5,val32,fma(val1,val28,acc5)))))))));
    acc6 = fma(val21,val60,fma(val24,val56,fma(val20,val52,fma(val12,val48,fma(val15,val44,fma(val11,val40,fma(val3,val36,fma(val6,val32,fma(val2,val28,acc6)))))))));
    acc7 = fma(val26,val60,fma(val25,val56,fma(val21,val52,fma(val17,val48,fma(val16,val44,fma(val12,val40,fma(val8,val36,fma(val7,val32,fma(val3,val28,acc7)))))))));
    acc8 = fma(val19,val61,fma(val22,val57,fma(val18,val53,fma(val10,val49,fma(val13,val45,fma(val9,val41,fma(val1,val37,fma(val4,val33,fma(val0,val29,acc8)))))))));
    acc9 = fma(val20,val61,fma(val23,val57,fma(val19,val53,fma(val11,val49,fma(val14,val45,fma(val10,val41,fma(val2,val37,fma(val5,val33,fma(val1,val29,acc9)))))))));
    acc10 = fma(val21,val61,fma(val24,val57,fma(val20,val53,fma(val12,val49,fma(val15,val45,fma(val11,val41,fma(val3,val37,fma(val6,val33,fma(val2,val29,acc10)))))))));
    acc11 = fma(val26,val61,fma(val25,val57,fma(val21,val53,fma(val17,val49,fma(val16,val45,fma(val12,val41,fma(val8,val37,fma(val7,val33,fma(val3,val29,acc11)))))))));
    acc12 = fma(val19,val62,fma(val22,val58,fma(val18,val54,fma(val10,val50,fma(val13,val46,fma(val9,val42,fma(val1,val38,fma(val4,val34,fma(val0,val30,acc12)))))))));
    acc13 = fma(val20,val62,fma(val23,val58,fma(val19,val54,fma(val11,val50,fma(val14,val46,fma(val10,val42,fma(val2,val38,fma(val5,val34,fma(val1,val30,acc13)))))))));
    acc14 = fma(val21,val62,fma(val24,val58,fma(val20,val54,fma(val12,val50,fma(val15,val46,fma(val11,val42,fma(val3,val38,fma(val6,val34,fma(val2,val30,acc14)))))))));
    acc15 = fma(val26,val62,fma(val25,val58,fma(val21,val54,fma(val17,val50,fma(val16,val46,fma(val12,val42,fma(val8,val38,fma(val7,val34,fma(val3,val30,acc15)))))))));
  }
  var  val63 = f32(f32(data3[gidx0*(4)]));
  var  val64 = f32(f32(data3[(gidx0*(4))+(1)]));
  var  val65 = f32(f32(data3[(gidx0*(4))+(2)]));
  var  val66 = f32(f32(data3[(gidx0*(4))+(3)]));
  var  val67 = f32(f32(data4[gidx0*(4)]));
  var  val68 = f32(f32(data4[(gidx0*(4))+(1)]));
  var  val69 = f32(f32(data4[(gidx0*(4))+(2)]));
  var  val70 = f32(f32(data4[(gidx0*(4))+(3)]));
  var  val71 = f32(f32(data5[gidx0*(4)]));
  var  val72 = f32(f32(data5[(gidx0*(4))+(1)]));
  var  val73 = f32(f32(data5[(gidx0*(4))+(2)]));
  var  val74 = f32(f32(data5[(gidx0*(4))+(3)]));
  var  val75 = f32(f32(data6[gidx0*(4)]));
  var  val76 = f32(f32(data6[(gidx0*(4))+(1)]));
  var  val77 = f32(f32(data6[(gidx0*(4))+(2)]));
  var  val78 = f32(f32(data6[(gidx0*(4))+(3)]));
  var  alu2 = sqrt(((1.0f)/(val71+(0.001f))));
  var  alu3 = sqrt(((1.0f)/(val72+(0.001f))));
  var  alu4 = sqrt(((1.0f)/(val73+(0.001f))));
  var  alu5 = sqrt(((1.0f)/(val74+(0.001f))));
  var  alu6 = (((acc0-val63)*val67*alu2)+val75);
  var  alu7 = (((acc1-val63)*val67*alu2)+val75);
  var  alu8 = (((acc2-val63)*val67*alu2)+val75);
  var  alu9 = (((acc3-val63)*val67*alu2)+val75);
  var  alu10 = (((acc4-val64)*val68*alu3)+val76);
  var  alu11 = (((acc5-val64)*val68*alu3)+val76);
  var  alu12 = (((acc6-val64)*val68*alu3)+val76);
  var  alu13 = (((acc7-val64)*val68*alu3)+val76);
  var  alu14 = (((acc8-val65)*val69*alu4)+val77);
  var  alu15 = (((acc9-val65)*val69*alu4)+val77);
  var  alu16 = (((acc10-val65)*val69*alu4)+val77);
  var  alu17 = (((acc11-val65)*val69*alu4)+val77);
  var  alu18 = (((acc12-val66)*val70*alu5)+val78);
  var  alu19 = (((acc13-val66)*val70*alu5)+val78);
  var  alu20 = (((acc14-val66)*val70*alu5)+val78);
  var  alu21 = (((acc15-val66)*val70*alu5)+val78);
  data0[(gidx0*(245760))+(gidx1*(2560))+(gidx2*(64))+(lidx3*(320))+(lidx4*(4))] = (alu6*((1.0f)/((1.0f)+exp2((alu6*((-1.4426950408889634f)))))));
  data0[(gidx0*(245760))+(gidx1*(2560))+(gidx2*(64))+(lidx3*(320))+(lidx4*(4))+(1)] = (alu7*((1.0f)/((1.0f)+exp2((alu7*((-1.4426950408889634f)))))));
  data0[(gidx0*(245760))+(gidx1*(2560))+(gidx2*(64))+(lidx3*(320))+(lidx4*(4))+(2)] = (alu8*((1.0f)/((1.0f)+exp2((alu8*((-1.4426950408889634f)))))));
  data0[(gidx0*(245760))+(gidx1*(2560))+(gidx2*(64))+(lidx3*(320))+(lidx4*(4))+(3)] = (alu9*((1.0f)/((1.0f)+exp2((alu9*((-1.4426950408889634f)))))));
  data0[(gidx0*(245760))+(gidx1*(2560))+(gidx2*(64))+(lidx3*(320))+(lidx4*(4))+(61440)] = (alu10*((1.0f)/((1.0f)+exp2((alu10*((-1.4426950408889634f)))))));
  data0[(gidx0*(245760))+(gidx1*(2560))+(gidx2*(64))+(lidx3*(320))+(lidx4*(4))+(61441)] = (alu11*((1.0f)/((1.0f)+exp2((alu11*((-1.4426950408889634f)))))));
  data0[(gidx0*(245760))+(gidx1*(2560))+(gidx2*(64))+(lidx3*(320))+(lidx4*(4))+(61442)] = (alu12*((1.0f)/((1.0f)+exp2((alu12*((-1.4426950408889634f)))))));
  data0[(gidx0*(245760))+(gidx1*(2560))+(gidx2*(64))+(lidx3*(320))+(lidx4*(4))+(61443)] = (alu13*((1.0f)/((1.0f)+exp2((alu13*((-1.4426950408889634f)))))));
  data0[(gidx0*(245760))+(gidx1*(2560))+(gidx2*(64))+(lidx3*(320))+(lidx4*(4))+(122880)] = (alu14*((1.0f)/((1.0f)+exp2((alu14*((-1.4426950408889634f)))))));
  data0[(gidx0*(245760))+(gidx1*(2560))+(gidx2*(64))+(lidx3*(320))+(lidx4*(4))+(122881)] = (alu15*((1.0f)/((1.0f)+exp2((alu15*((-1.4426950408889634f)))))));
  data0[(gidx0*(245760))+(gidx1*(2560))+(gidx2*(64))+(lidx3*(320))+(lidx4*(4))+(122882)] = (alu16*((1.0f)/((1.0f)+exp2((alu16*((-1.4426950408889634f)))))));
  data0[(gidx0*(245760))+(gidx1*(2560))+(gidx2*(64))+(lidx3*(320))+(lidx4*(4))+(122883)] = (alu17*((1.0f)/((1.0f)+exp2((alu17*((-1.4426950408889634f)))))));
  data0[(gidx0*(245760))+(gidx1*(2560))+(gidx2*(64))+(lidx3*(320))+(lidx4*(4))+(184320)] = (alu18*((1.0f)/((1.0f)+exp2((alu18*((-1.4426950408889634f)))))));
  data0[(gidx0*(245760))+(gidx1*(2560))+(gidx2*(64))+(lidx3*(320))+(lidx4*(4))+(184321)] = (alu19*((1.0f)/((1.0f)+exp2((alu19*((-1.4426950408889634f)))))));
  data0[(gidx0*(245760))+(gidx1*(2560))+(gidx2*(64))+(lidx3*(320))+(lidx4*(4))+(184322)] = (alu20*((1.0f)/((1.0f)+exp2((alu20*((-1.4426950408889634f)))))));
  data0[(gidx0*(245760))+(gidx1*(2560))+(gidx2*(64))+(lidx3*(320))+(lidx4*(4))+(184323)] = (alu21*((1.0f)/((1.0f)+exp2((alu21*((-1.4426950408889634f)))))));
}
"""
#print(str(help(wgpu_device.create_shader_module)))
wgpu_device.create_shader_module(code=prg)
